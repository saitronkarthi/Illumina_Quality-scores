HW 7

You have read somewhere that the quality scores generally decline along
sequenced reads generated by Illumina technology. You were also told that
quality scores for Read2 are generally worse than for Read1. To check if this
information is correct, you decide to write a script to analyze quality
scores in fastq files generated from genome sequencing of Drosophila melanogaster.

First, download SRR203502 from https://www.ncbi.nlm.nih.gov/sra/ 
from LOGIN node (should take no more than 2 min). Copy this file
to $SCRATCH directory.
 
Now you are ready to write a script to analyze SRR203502.

This is what your script should do:

1. Extract Read1 and Read2 data for first 5000 spots from SRR203502.
2. Record read counts for each file.
3. Run `fastx_quality_stats` from Fastx toolkit on each file.
4. Record 5 base positions with lowest mean quality score
and 5 positions with highest mean score for each file
(use the output of step 3 to extract this information). 
5. Filter your fastq files by quality using
`fastq_quality_filter` from Fastx toolkit. Keep reads that
have quality score of 15 or more for at least 70% of bases in every read.
6. Record read counts for each filtered file.
7. Run `fastx_quality_stats` from Fastx toolkit on each filtered file.
8. Record 5 base positions with lowest mean quality score
and 5 positions with highest mean score for each filtered file
(use the output of step 7 to extract this information).
9. Save your results in Results.txt file.
10. Make $WORK/HW7 directory.
11. Copy Results.txt to $WORK/HW7.

Here is a partial(tab-delimited) output stored in Results.txt
(you should also provide the same information for the second fastq file)
What do your results tell you about base qualities within and between reads?
----------------------------------------------------------
SRR203502_1.fastq before quality filter: Total Reads: 5000
Position        Score
146     14.06
145     14.18
144     14.44
143     14.66
142     14.88
13      37.81
17      37.81
18      37.81
6       37.81
11      37.90
SRR203502_1.fastq after quality filter: Total Reads: 4057
Position        Score
146     16.86
145     17.01
144     17.33
143     17.60
142     17.87
7       38.39
16      38.40
6       38.40
18      38.42
11      38.44
...
...
...
...
----------------------------------------------------------

Save your script as HW7_fastqAnalysis_YourFirstName_YourLastName.sh to
$HOME/Scripts. Copy .sh file to $SCRATCH.

Write a slurm script (fastq_sbatch_YourFirstName_YourLastName.sh)
and submit your job to ls5 from login node. Set job time to 20 min.
Do not set email notifications.
Save both .sh files to $SCRATCH and run slurm script from there.

Further Instructions:
This homework is mostly based on Lessons 13 and 14. Read lesson notes.
Comment every line of code in your script (it will help you!).
Test every command individully from the command line, but start idev
session first.
Note: you do not need to provide arguments at the command line if you
do not want to, but notice that this makes your script less flexible.

Submit 3 files to Blackboard:
1.Your analysis script: HW7_fastqAnalysis_YourFirstName_YourLastName.sh
2.Your Results.txt
3.Slurm script: fastq_sbatch_YourFirstName_YourLastName.sh